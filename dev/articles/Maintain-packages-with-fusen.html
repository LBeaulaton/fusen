<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Maintain packages with {fusen} • fusen</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Bootstrap --><link href="../cosmo.css" rel="stylesheet">
<link href="../thinkr.css" rel="stylesheet">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Maintain packages with {fusen}">
<meta property="og:description" content="fusen">
<meta property="og:image" content="https://thinkr-open.github.io/fusen/logo.png">
<meta name="twitter:card" content="summary">
<meta name="robots" content="noindex">
<!-- mathjax
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>
--><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!--  Code folding --><script src="../codefolding.js"></script><link href="../codefolding.css" rel="stylesheet">
<!--
<script>
         document.write('<div class="navbar"><div class="container"><div id="code-folding-buttons" class="btn-group"><button class="btn btn-default btn-xs dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" data-_extension-text-contrast=""><span>Show/Hide all code</span><span class="caret"></span></button><ul class="dropdown-menu" style="min-width: 50px;"><li><a id="rmd-show-all-code" href="#">Show All Code</a></li><li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li></ul></div></div></div>')
</script>
--><!-- google analytics
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-115082821-1"></script>
<script>
 window.dataLayer = window.dataLayer || [];
 function gtag(){dataLayer.push(arguments);}
 gtag('js', new Date());

 gtag('config', 'UA-115082821-1');
</script>
-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">fusen</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">0.2.4.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/How-to-use-fusen.html">How to use fusen</a>
    </li>
    <li>
      <a href="../articles/Maintain-packages-with-fusen.html">Maintain packages with {fusen}</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
          <div id="code-folding-buttons" class="btn-group">
<button class="btn btn-default btn-xs dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" data-_extension-text-contrast=""><span>Show/Hide all code</span><span class="caret"></span></button><ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>
        </li>
        <li>
  <a href="https://github.com/Thinkr-open/fusen/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Maintain-packages-with-fusen_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Maintain packages with {fusen}</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/Thinkr-open/fusen/blob/master/vignettes/Maintain-packages-with-fusen.Rmd"><code>vignettes/Maintain-packages-with-fusen.Rmd</code></a></small>
      <div class="hidden name"><code>Maintain-packages-with-fusen.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://thinkr-open.github.io/fusen/">fusen</a></span><span class="op">)</span></code></pre></div>
<div id="daily-use-of-fusen" class="section level1">
<h1 class="hasAnchor">
<a href="#daily-use-of-fusen" class="anchor"></a>Daily use of {fusen}</h1>
<div id="add-a-new-set-of-chunks-in-the-current-rmd" class="section level2">
<h2 class="hasAnchor">
<a href="#add-a-new-set-of-chunks-in-the-current-rmd" class="anchor"></a>Add a new set of chunks in the current Rmd</h2>
<p>Use the Addin “Add {fusen} chunks”</p>
<ul>
<li>Name the chunks using function name planned to be created</li>
<li>Decide if this function is exported to the user or not</li>
</ul>
</div>
<div id="create-a-new-flat-rmd-template" class="section level2">
<h2 class="hasAnchor">
<a href="#create-a-new-flat-rmd-template" class="anchor"></a>Create a new flat Rmd template</h2>
<p>To add a new family of functions, create a new flat Rmd template</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/add_flat_template.html">add_flat_template</a></span><span class="op">(</span>template <span class="op">=</span> <span class="st">"add"</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="how-to-maintain-a-fusen-can-i-use-fusen-with-old-way-packages" class="section level1">
<h1 class="hasAnchor">
<a href="#how-to-maintain-a-fusen-can-i-use-fusen-with-old-way-packages" class="anchor"></a>How to maintain a {fusen}? Can I use {fusen} with old-way packages ?</h1>
<p>After you <code><a href="../reference/inflate.html">inflate()</a></code> the “flat_template.Rmd”, your code appears twice in the package. In the “flat_template.Rmd” itself and in the correct place for it to be a package. Take it as a documentation for the other developers.<br>
Maintaining such a package requires a choice:</p>
<ul>
<li>
<strong>Option 1</strong>: Modifications are only added to the “flat_template.Rmd” file, which then is inflated to update all packages files</li>
<li>
<strong>Option 2</strong>: Modifications are realized in the package files directly, and the “flat_template.Rmd” file must be protected from any use.</li>
</ul>
<p>Your first <code><a href="../reference/inflate.html">inflate()</a></code> may not directly work as expected as with any R code that you write. In this case, you can continue to implement your functionality using <strong>Option 1</strong>.</p>
<blockquote>
<p>Advice 1 : Use Option 1 until you find it too complicated to be used ! I assure you, you will find the moment when you say : ok this is not possible anymore…</p>
</blockquote>
<blockquote>
<p>Advice 2 : Use git as soon as possible, this will avoid losing your work if you made some modifications in the wrong place</p>
</blockquote>
<div id="option-1-continue-with-the-flat_template-rmd" class="section level2">
<h2 class="hasAnchor">
<a href="#option-1-continue-with-the-flat_template-rmd" class="anchor"></a>Option 1: Continue with the “flat_template.Rmd”</h2>
<ul>
<li>(+) This does not require to fully understand the package structure and files to continue building your package, and you continue to develop in a unique file</li>
<li>(+) You are encouraged to continue documenting and testing all parts of your package</li>
<li>(-) You need to pay attention to checking and debugging tools that may direct you to the R file directly. This requires to pay attention and always be sure you are modifying code in the flat template file, to be inflated.</li>
<li>(-) This may trouble co-developers who already built packages</li>
</ul>
<p>=&gt; {fusen} itself is built as is. Each modification is added to the dedicated dev_history file and then inflated</p>
</div>
<div id="option-2-maintain-like-a-classical-package" class="section level2">
<h2 class="hasAnchor">
<a href="#option-2-maintain-like-a-classical-package" class="anchor"></a>Option 2: Maintain like a classical package</h2>
<ul>
<li>(+) You can use dedicated checking and debugging tools as is, in particular in RStudio. There are built to direct you as quickly as possible to the source of the problem</li>
<li>(+) This allows collaboration with more advanced developers who are used to debug in the package structure directly</li>
<li>(-) This requires to understand the structure and files of a package and how they interact each other, and be able to jump from one file to the other, in the correct folder. This may drives you lazy to continue documenting and testing your modifications</li>
<li>This requires to protect the flat template file, so that you never use it again. <code>&lt;!-- Do not edit by hand--&gt;</code> is the minimum. Then you can add <code>&lt;!-- File used to start new functionalities, do not use anymore, go directly to appropriate files in the package --&gt;</code>, and you can rename the old template with “old-flat_template.Rmd” for instance.</li>
</ul>
<p>=&gt; This is the way I add new functionalities in packages that started in the old way, and in specific cases where inflating is now too complicated, like for function <code><a href="../reference/inflate.html">inflate()</a></code> and all its unit tests in this very {fusen} package.</p>
</div>
</div>
<div id="what-about-packages-already-built-the-old-way" class="section level1">
<h1 class="hasAnchor">
<a href="#what-about-packages-already-built-the-old-way" class="anchor"></a>What about packages already built the old way ?</h1>
<p>The “flat_template.Rmd” template only modifies files related to functions presented inside the template. <strong>This does not remove or modify previous functions, tests or vignettes, provided that names are different.</strong></p>
<ul>
<li>{fusen} itself was started in the classical way before having enough functions to be able to build a package from itself. This does not prevent me at all to use {fusen} to build himself now !</li>
<li>If you want to modify existing functionalities, you will need to continue maintain your already-built package in the classical way</li>
<li>If you want to add new functionalities, correctly documented and tested, you can use {fusen}. This will not delete previous work.</li>
<li>Use the “Option 2” above to continue after the development of your functionality</li>
</ul>
<div id="lets-try-to-convince-package-developers-with-an-example" class="section level2">
<h2 class="hasAnchor">
<a href="#lets-try-to-convince-package-developers-with-an-example" class="anchor"></a>Let’s try to convince package developers with an example</h2>
<ul>
<li>Install {fusen} : <code>install.packages("fusen")</code>
</li>
<li>Open a project for <strong>one of your already existing package</strong>
<ul>
<li>Commit your previous state if you are afraid of {fusen}</li>
<li>If you are not sure enough to do it on an existing package, then follow the guide in <a href="https://thinkr-open.github.io/fusen/articles/How-to-use-fusen.html">“How to use fusen”</a>
</li>
</ul>
</li>
<li>Run in the Console : <code>fusen::add_flat_template("add")</code>
<ul>
<li>A Rmd file appears in “dev/flat_additional.Rmd”. Open it.</li>
</ul>
</li>
<li>Add a new function in the <code>function</code> chunk. For instance:</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#' My median</span>
<span class="co">#'</span>
<span class="co">#' @param x Vector of Numeric values</span>
<span class="co">#' @inheritParams stats::median</span>
<span class="co">#'</span>
<span class="co">#' @return</span>
<span class="co">#' Median of vector x</span>
<span class="co">#' @export</span>
<span class="co">#'</span>
<span class="co">#' @examples</span>
<span class="va">my_median</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">na.rm</span> <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">{</span>
  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">is.numeric</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span><span class="kw"><a href="https://rdrr.io/r/base/stop.html">stop</a></span><span class="op">(</span><span class="st">"x should be numeric"</span><span class="op">)</span><span class="op">}</span>
  <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">x</span>, na.rm <span class="op">=</span> <span class="va">na.rm</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<ul>
<li>Add a corresponding example in the <code>example</code> chunk. For instance:</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">my_median</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span></code></pre></div>
<ul>
<li>Add a corresponding unit test in the <code>test</code> chunk. For instance:</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">test_that</span><span class="op">(</span><span class="st">"my_median works properly and show error if needed"</span>, <span class="op">{</span>
  <span class="fu">expect_true</span><span class="op">(</span><span class="fu">my_median</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span> <span class="op">==</span> <span class="fl">6.5</span><span class="op">)</span>
  <span class="fu">expect_error</span><span class="op">(</span><span class="fu">my_median</span><span class="op">(</span><span class="st">"text"</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span><span class="op">)</span></code></pre></div>
<ul>
<li>Run command of the last chunk: <code>fusen::inflate(rmd = "dev/flat_additional.Rmd")</code>
<ul>
<li>This will run {attachment} behind the scene and may modify the list of dependencies in the DESCRIPTION file accordingly. Use <code>fusen::inflate(rmd = "dev/flat_additional.Rmd", document = FALSE)</code> to avoid that.</li>
<li>This will also run <code>devtools::check()</code>. Use <code>fusen::inflate(rmd = "dev/flat_additional.Rmd", check = FALSE)</code> to avoid that.</li>
</ul>
</li>
</ul>
<p><strong>That’s it!</strong><br>
You added a new function in your package, along with example, test and a new vignette:</p>
<ul>
<li>R/my_median.R</li>
<li>tests/testthat/test-my_median.R</li>
<li>vignettes/get-started.Rmd</li>
</ul>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="thinkr">
  <p>fusen is a  <strong>ThinkR</strong> package. Learn more at <a href="https://rtask.thinkr.fr">rtask.thinkr.fr</a>.</p>
</div>

<div class="author">
  <p>
    Developed by Sebastien Rochette.
    Site built by <a href="https://pkgdown.r-lib.org">pkgdown</a>.
  </p>
</div>

      </footer>
</div>

  


  </body>
</html>
